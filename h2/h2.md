# H2 Karjaa #

## x) ## 
**Slater 2017: What is the definition of "cattle not pets"?**

- Palvelimia, joita kohdellaan kuin lemmikkiä tarkoittaa sitä, että ne on rakennettu käsin, niitä operoidaan käsin ja niiden kaatuessa palvelu pysähtyy.
- Palvelimia tulisi kohdella kuin karjaa eli ne voidaan korvata toisella palvelimella heti ilman että palvelu kaatuu.

Lähde: https://devops.stackexchange.com/questions/653/what-is-the-definition-of-cattle-not-pets#654

**Karvinen 2017: Vagrant Revisited – Install & Boot New Virtual Machine in 31 seconds**
- Vagrantilla voidaan asentaa uusi virtuaalikone automaattiseti.
- Laitetta voidaan ohjata ssh-yhteydellä alle minuutissa.

  Asennuskomennot:
  
- `$ sudo apt-get update`
- `$ sudo apt-get -y install vagrant virtualbox`

  Uuden koneen luonti ja ssh yhteys:  
- `$ vagrant init bento/ubuntu-16.04`
- `$ vagrant up`
- `$ vagrant ssh`

Lähde: https://terokarvinen.com/2017/04/11/vagrant-revisited-install-boot-new-virtual-machine-in-31-seconds/

**Karvinen 2023: Salt Vagrant - automatically provision one master and two slaves**
- Konfiguraatiohallinnan avulla voi kontrolloida satoja koneita
- Artikkelissa luodaan saltin kokeiluun valmis kolmen koneen välinen verkko.

Lähde: https://terokarvinen.com/2023/salt-vagrant/

  **Käytin tässä raportissa Windows 10 käyttöjärjestelmässä pyörivää virtualbox versiota 7.0.10, jossa on asennettuna 64 bittinen debian 12.1.0 versio.**
## a) Asenna Vagrant ##

Asensin Vagrantin omalla koneelle ja asennuksessa käytin tiedostoa "tiedostoa "vagrant_2.4.0_windows_amd64.msi"  
Asennuksen jälkeen tietokone täytyi käynnistää uudelleen. 


## b) Yksi maankiertäjä. Asenna yksi kone Vagrantilla, ota siihen SSH-yhteys, osoita että netti toimii. ##

Käytin Vagrantia windowsin komentorivillä ja poweshellillä.  
Vagrantilla voi luoda boxin, jota käytetään tietokoneen kloonauksessa. Boxin avulla levykuvaan ei tule muutoksia.  
Loin uuden boxin komennolla `vagrant box add hashicorp/bionic64`

![alt text](https://github.com/faltjon/Infra-as-code/blob/main/h2/kuvat/1-box.png " ")

Tämän jälkeen vaihdoin Poweshelliin, koska siihen voi kopioida komentoja.

Loin uuden virtuaalikoneen komennolla  `vagrant init hashicorp/bionic64`

![alt text](https://github.com/faltjon/Infra-as-code/blob/main/h2/kuvat/2-init.png " ")

Nyt kone näkyi virtualboxissa

![alt text](https://github.com/faltjon/Infra-as-code/blob/main/h2/kuvat/3-virtualbox.png " ")

Otin SSH-yhteyden koneeseen `vagrant ssh`

![alt text](https://github.com/faltjon/Infra-as-code/blob/main/h2/kuvat/4-ssh.png " ")

Testasin, että netti toimii `ping www.google.fi`

![alt text](https://github.com/faltjon/Infra-as-code/blob/main/h2/kuvat/5-netti.png " ")

Pingit meni läpi.

Lähteet: 
https://developer.hashicorp.com/vagrant/tutorials/getting-started/getting-started-boxes
https://developer.hashicorp.com/vagrant/tutorials/getting-started/getting-started-up
https://oispadotka.wordpress.com/2020/05/12/h6/

## c) Oma orjansa. Asenna Salt herra ja orja samalle koneelle. ##

## d) Asenna Saltin herra-orja arkkitehtuuri toimimaan verkon yli. ##

Asensin Vagrantin Virtualboxissa pyörivälle debian 12 `$ sudo apt-get install vagrant`  
Loin uuden kansion hakemistoon /home/joni/saltdemo komennolla `$ mkdir saltdemo`  
Loin Vagrantfile tiedoston tähän hakemistoon `$ micro Vagrantfile` ja kopioin sinne ohjeessa mainitun konfiguraation

![alt text](https://github.com/faltjon/Infra-as-code/blob/main/h2/kuvat/6-vagrantfile.png " ")

Ajaessani `$ vagrant up`komennon sain seuraavanlaisen virheilmoituksen:
![alt text](https://github.com/faltjon/Infra-as-code/blob/main/h2/kuvat/10-error2.png " ")

Oletan että virhe johtuu siitä, kun virtualboxia ei ole asennettu.

Virtualboxia asentasessa tulee tällainen ilmoitus:

![alt text](https://github.com/faltjon/Infra-as-code/blob/main/h2/kuvat/7-error.png " ")

Ja kun valitsen vaikka Virtualbox-7.0 version tulee ilmoitus:

![alt text](https://github.com/faltjon/Infra-as-code/blob/main/h2/kuvat/11-error3.png " ")

Yritin suorittaa koneiden luonnin powershellissä, mutta silloin sain luotua vain yhden koneen.  
En pysty jatkamaan tästä eteenpäin, joten aion kysyä seuraavalla luennolla apua aiheeseen.
